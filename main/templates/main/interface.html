{% extends 'main/base.html' %}

{% block content %}

    {% load static %}

    <link rel="stylesheet" type="text/css" href="{% static 'main/interface.css' %}">
    <div layout="column" class="full-row" ng-controller="interfaceController as ctrl">
        <div id="center-row" class="full-row" layout="row">
            <div id="left-spacer" layout="column"></div>
            {# CHOOSEN TRAITS FROM THIS POINT #}
            <div id="left-panel" layout="column">
                <div id="chosen-list">
                    <div ng-repeat="trait in ctrl.chosenTraits"
                         ng-click="ctrl.toggleTrait(trait.title, trait.price, trait.sale_price)" layout="row"
                         layout-align="start center" class="fadeInOut">
                        <div class="coded-trait">
                            {% verbatim %}
                            {{ ctrl.traitToBinary(trait.name) }}
                            {% endverbatim %}
                        </div>
                        <h3 class="trait-list">
                            {% verbatim %}
                            {{ trait.title }}
                            {% endverbatim %}
                        </h3>

                    </div>
                </div>
            </div>
            {# TRAIT SELECTION FROM THIS POINT #}
            <div id="right-panel" layout="column">
                {% for topic in topics %}
                    <md-button class="topic md-raised"
                               ng-click="open_topics['{{ topic }}'] = !open_topics['{{ topic }}']">
                        {{ topic.name }}
                    </md-button>
                    <div class="collapsible" ng-show="open_topics['{{ topic }}']">
                        {% for trait in topic.trait_set.all %}
                            <div>
                                <md-card
                                        ng-click="ctrl.toggleTrait('{{ trait.title }}', {{ trait.price }},
                                        {{ trait.sale_price }})">
                                    <md-card-title>{{ trait.title }}</md-card-title>
                                    <md-card-content>
                                        {{ trait.description }}
                                        <br/>
                                        {{ trait.price }}
                                        {% if trait.sale_price %}
                                            now for {{ trait.sale_price }}
                                        {% endif %}
                                    </md-card-content>
                                    <md-card-footer class="footer-save-space">
                                        {% if trait.sale %}
                                            {{ trait.sale }} {{ trait.company }}
                                        {% endif %}
                                        <md-icon ng-show="ctrl.isTraitChosen('{{ trait.title }}')"
                                                 class="check-mark">
                                            done
                                        </md-icon>
                                    </md-card-footer>
                                </md-card>
                            </div>
                        {% endfor %}
                    </div>
                {% endfor %}
                <md-button class="topic cover md-raised">
                </md-button>
            </div>
        </div>
        <div id="bottom-row" class="full-row" layout="row" layout-align="end center">
            <h1 id="total-price">
                {% verbatim %}
                {{ ctrl.currentPriceFormatted() | currency : "â‚¬" : 2 }}
                {% endverbatim %}
            </h1>
            <md-button id="done-button" class="md-raised">Finish</md-button>
        </div>
    </div>
{% endblock %}